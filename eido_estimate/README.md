# EIDO Estimate: ML Model Experimentation

This directory contains the code and resources for a machine learning experiment designed to validate the core hypothesis of the SentinelAI project:

**Hypothesis:** Training an ML model on structured data (EIDO-JSONs) provides a significant performance improvement over training on raw, unstructured text for predictive tasks in the public safety domain.

## The Experiment

We will train a model to perform a classification task relevant to emergency response: **Incident Priority Prediction**. The model will predict the priority level (e.g., 1=High, 2=Medium, 3=Low) based on the initial report.

### Datasets for Comparison

Two modeling approaches will be compared:

1.  **Baseline Model (Raw Text)**: This model is trained directly on the raw, unstructured text of incident reports. This represents the traditional approach without the benefits of data structuring.
2.  **EIDO-Enhanced Model (Structured Features)**: This model is trained on features engineered from the structured EIDO-JSON format. The EIDO-JSON is generated by processing the raw text through the SentinelAI EIDO Agent. Features include explicit counts of victims/suspects, standardized incident types, and the presence of key items like weapons.

### Methodology

1.  **Data Simulation**: The `train_model.py` script and `experiment.ipynb` notebook use a small, simulated dataset that includes raw text, the corresponding EIDO-JSON that would be generated, and a priority label.
2.  **Model Training**:
    *   The baseline model uses a TF-IDF vectorizer to convert text into numerical features.
    *   The EIDO-enhanced model uses features extracted from the JSON, with one-hot encoding for categorical data.
    *   Both approaches use a `GradientBoostingClassifier` for a fair comparison.
3.  **Evaluation**: The models are compared on a held-out test set using standard classification metrics: accuracy, precision, recall, and F1-score.

### Expected Outcome

The EIDO-enhanced model is expected to outperform the baseline model. The structured, annotated data from the EIDO-JSON provides a cleaner, less noisy, and more explicit signal, allowing the machine learning model to learn the underlying patterns of incident severity more effectively. This experiment aims to provide quantitative proof of the value added by the SentinelAI data structuring pipeline.

### How to Run

#### Using Python
```bash
# From the 'sentinelai/eido_estimate' directory
pip install -r requirements.txt
python train_model.py
```

#### Using Jupyter Notebook
```bash
# From the 'sentinelai/eido_estimate' directory
pip install -r requirements.txt
jupyter lab experiment.ipynb
```

#### Using Docker
```bash
# From the 'sentinelai/eido_estimate' directory
docker build -t eido-estimate .
# Run the Jupyter Lab server
docker run -p 8888:8888 eido-estimate
```
Then, open the URL provided in the terminal in your browser.
